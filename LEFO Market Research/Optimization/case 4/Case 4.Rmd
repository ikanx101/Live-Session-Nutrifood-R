---
title: "Training Optimization"
subtitle: "Contoh Kasus"
author: "Ikanx Fadhli @nutrifood"
date: "21 Maret 2021"
output:
  html_document:
    toc: true
    toc_depth: 5
    toc_float: 
        collapsed: false
    number_sections: false
    theme: darkly
    highlight: pygments
    fig_caption: yes
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(scipen = 99)
```

# Kasus _Optimization_ IV

## Masalah

Suatu perusahaan memproduksi `4` warna cat yaitu:

- Putih,
- Kuning, 
- Hitam, dan 
- Merah. 

Keempat cat tersebut diproduksi di mesin-mesin yang sama, sehingga ada keperluan untuk mencuci mesin-mesin tersebut di antara produksi `2` cat yang berbeda warna.  

Kita mempunyai masalah untuk menentukan urutan produksi cat harian yang _optimal_, yakni urutan produksi cat yang menghasilkan total waktu pencucian paling kecil. 

> ___Urutan harian ini akan dipakai tiap hari, karena perusahaan setiap hari harus memproduksi keempat cat tersebut.___

Tabel berikut menampilkan waktu pencucian antara produksi cat di suatu baris jika akan dilanjutkan dengan cat di suatu kolom.

```{r,message=FALSE,warning=FALSE}
data = data.frame(putih = c(NA,20,50,45),
                  kuning = c(10,NA,44,40),
                  hitam = c(17,19,NA,20),
                  merah = c(15,18,25,NA))

row.names(data) = c("putih","kuning","hitam","merah")

options(knitr.kable.NA = '~')
knitr::kable(data,row.names = T,align = "c",caption = "Matriks Cleaning Mesin Cat (dalam menit)")
```

> ___Urutan produksi cat seperti apa yang meminimalkan waktu cleaning?___

## Metode Heuristik

Sebenarnya masalah di atas mirip sekali dengan __Travelling Salesperson Problem__, yakni suatu masalah _optimization_ yang mencari rute terpendek dari beberapa tempat. 

Jadi alih-alih menggunakan metode _Mixed Integer Linear Programming_ (__MILP__) yang biasa saya pakai untuk menyelesaikan _optimization_, saya akan menggunakan cara __TSP__ saja.

### _How to_

Langkah pertama adalah menyiapkan matriks cleaning terlebih dahulu, yakni dengan mengubah `data` yang berupa _dataframe_ ke bentuk _matrix_ di __R__.

```{r}
data[is.na(data)] = 0
level = rownames(data)
matriks = as.matrix(data)
matriks
```

Jika kita perhatikan dengan baik. Matriks _cleaning_ di atas berbentuk asimetris. Artinya waktu _cleaning_ dari cat `1` ke `2` __tidak sama__ dengan waktu _cleaning_ dari cat `2` ke `1`.

Oleh karena itu, saya akan membuat _problem_ __Assymetric TSP__ (__ATSP__) untuk kemudian di-_solve_.

```{r}
library(TSP)
problem = as.ATSP(matriks)
hasil = solve_TSP(problem)
hasil
```

Didapatkan waktu _cleaning_ terkecil adalah sebesar `98` menit.

### _Final Result_

Saya dapatkan urutan terbaik seperti ini: 

```{r} 
paste(level[as.integer(hasil)],collapse = " - ")
```

---