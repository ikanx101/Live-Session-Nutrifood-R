---
title: "Read Me First"
output: github_document
---

```{r setup, include=FALSE}
rm(list=ls()) # ini berguna untuk menghapus semua data yang ada di global environment
knitr::opts_chunk$set(echo = TRUE)
```

# *Dear Trainees*

## *Preface*

Selamat datang pada *live session* **training R** hari ini. Kali ini tim _trainer_ akan memfasilitasi *training* ini pada tema **Data Visualization**.

Semua materi *training* dan **R Markdown** yang dikerjakan saat *live* ini dapat dipantau juga melalui halaman `github` ini secara *realtime*.

## Materi *Training*

Materi *training* telah disiapkan oleh `Sigit` dan telah dikerjakan sebagian pada saat sesi di **Nutriversity**. Oleh karena itu, *rundown training* kali ini:

```{r,echo=FALSE,fig.retina=10}
nomnoml::nomnoml("[Sesi 1] -> [Sesi 2]
                 [Sesi 2] -> [Sesi 3]
                 [Sesi 1|
                    [Ikang] -> [Review Importing Data]
                    [Ikang] -> [Review Tidyverse]
                    [Sigit] -> [Review Lubridate]
                    [Ikang] -> [Review R Markdown]
                    ]
                 [Sesi 2|
                    [Sigit] -> [Praktek ggplot2]
                    ]
                 [Sesi 3|
                    [Sigit] -> [Praktek plotly]
                    ]
                 ")
```

### Sesi 1

Pada sesi 1 ini, saya akan melakukan *review* singkat terhadap materi dari *file* `pdf` yang telah dibaca dan dilakukan. Fokus pada materi tersebut adalah penggunaan `library(tidyverse)` yakni *function pipe*: `%>%`.

Selain itu, konsep dasar *importing* data dan *setting working directory* juga akan diingatkan kembali.

Setelah itu kita akan masuk ke materi dari `Sigit` mengenai `library(lubridate)`.


### Sesi 2

Pada sesi ini kita akan melakukan praktek langsung melanjutkan video dari `Sigit`. Diharapkan rekan-rekan *trainee* telah melakukan *workout* dan melengkapi *R Markdown* yang telah diberikan.

> Jika ternyata belum sempat dilengkapi, rekan-rekan bisa mengambilnya di halaman *github* ini.

Fokus bahasan dari sesi ini adalah melakukan visualisasi data dengan menggunakan `library(ggplot2)` tanpa melupakan keterkaitannya dengan *function pipe*: `%>%`.

#### Data dan *R Markdown* yang Digunakan

Selama training ini, ada tiga komponen yang harus masuk ke dalam *working directory*:

1.  Data `USvideos.csv`.
2.  *R Markdown* `Materi Data Viz Day 1.Rmd` (*file* `.Rmd` ini akan
    selalu *update*).
3.  *Folder* `asset`.

### Sesi 3

Pada sesi ini kita akan membuat visualisasi data interaktif dengan cara mengkonversi *object* `ggplot` ke dalam `plotly`.

-----

## **Ground Rules**

Berkaca dari pengalaman di *training batch* sebelumnya, maka pada *live session* kali ini akan ada beberapa peraturan, yakni:

1.  *Trainees* akan dibagi menjadi `3` buah kelompok. Masing-masing kelompok akan dibuatkan grup **QnA** terpisah dari grup *live session*. Di dalam setiap grup tersebut, akan ada *trainer fasilitator* yang sudah siap membantu.
2.  Jika ada permasalahan terkait *R markdown*, rekan-rekan bisa memanfaatkan grup **QnA** untuk menyelesaikannya dengan cara bertanya dan mengirimkan *file* `.Rmd` ke grup masing-masing. *Trainer fasilitator* akan mengecek file `.Rmd` rekan-rekan dan menginformasikan letak kesalahan yang terjadi.
3.  Jangan takut tertinggal materi, *file* `.Rmd` secara live akan terupdate di halaman *github* ini.


### Pembagian Kelompok

Berikut adalah pembagian kelompok untuk hari ini:

```{r,echo=FALSE,message=FALSE,warning=FALSE}
data = data.frame(
  No = c(1:11),
  Trainee = c("Andre Kurniawan","Dimas Dwi Santoso","David Auw","Harinto Anggoro",
              "Muhammad Rizqi","Widio Widodo","Mochammad Miftahul Fahmi","Willianto",
              "Claireta","Rendy","Lince"),
  Fasilitator = c(rep("Ikang - Sigit",4),rep("Teguh",4),rep("Lenny",3))
)
knitr::kable(data,"simple",caption = "Kelompok Live Session")

rm(list=ls())
library(dplyr)
```

___________


# Review Sebentar Materi yang ada di `pdf`

## Review Materi `importing data`

Untuk mengambil data berupa file excel, kita memerlukan `library(readxl)`. Ingat _yah_, kita bisa memanggil keseluruhan _library_ dengan perintah:

1. `library(readxl)` atau
1. `readxl::nama_function`.

Tapi ingat lagi _yah_:

> Pastikan bahwa data yang mau kita ambil ada di _working directory_ kita! 

Bagaimana jika data tidak ada di _working directory_? Artinya kita harus menuliskan _full path_ dari file data kita.

Kali ini, saya akan menuliskan _full path_ data saya _yah_.

```{r,message=FALSE,warning=FALSE}
rm(list=ls()) # ini berguna untuk menghapus semua data yang ada di global environment

library(readxl)
data = read_excel("~/Documents/Training-R---Data-Viz/DATA LATIHAN.xlsx")
```

Sekarang, kita coba tampilkan 5 data teratas dengan cara:

```{r,message=FALSE,warning=FALSE}
head(data,5)
```

Mari kita lihat struktur dan tipe data yang kita miliki dengan cara:

```{r,message=FALSE,warning=FALSE}
str(data)
```
## Review Materi _Pipe_ `%>%`

`%>%` berguna untuk melakukan _data manipulation_: data carpentry.

Untuk menggunakan _function_ _pipe_ `%>%`, kita harus memanggil _library_ terlebih dahulu. Ada beberapa _Libraries_ yang bisa digunakan agar _function_ _pipe_ bisa digunakan:

1. `library(tidyverse)` --> analogi mirip bom atom.
1. `library(dplyr)` --> _prefer_ pakai ini saja.
1. `library(magrittr)`

Saya akan gunakan `library(dplyr)` saja _ya_. Mari kita panggil _library_-nya.

```{r,message=FALSE,warning=FALSE}
library(dplyr)
```

Oh iya, kita akan ubah bulan agar urut yah. Caranya adalah dengan mengubah `character` menjadi `factor`.

```{r,message=FALSE,warning=FALSE}
data = 
  data %>% 
  mutate(bulan = factor(bulan,levels = c("Jan","Feb","Mar","Apr")))

str(data)
```

Oke sekarang kita akan coba oprek informasi apa saja yang bisa kita ambil dari data tersebut _yah_.

_____

### Apakah Ada Perubahan _Habit_ Belanja?

Ingat untuk menghapus `PLAS TIK` dari data belanjaan ini dulu _yah_!

```{r,message=FALSE,warning=FALSE}
data = 
  data %>% 
  filter(sku != "PLAS TIK") 
```

Mari kita jawab pertanyaan di atas dengan menghitung:

#### Total belanja konsumen per bulannya:

```{r,message=FALSE,warning=FALSE}
belanja_per_bulan = 
  data %>% 
  mutate(omset = qty * total_harga) %>% 
  group_by(bulan) %>% 
  summarise(omset = sum(omset)) %>% 
  ungroup()

belanja_per_bulan
```

Berikut adalah contoh visualisasi dari data di atas:

```{r,echo=FALSE,warning=FALSE,message=FALSE,fig.retina=10}
library(ggplot2)

belanja_per_bulan %>% 
  mutate(label = omset / 1000000,
         label = round(label,2),
         label = paste0("Rp",label," jt")) %>% 
  ggplot(aes(x = bulan,
             y = omset)) +
  geom_col(color = "black",aes(fill = omset)) +
  geom_label(aes(label = label),size = 3) +
  theme_minimal() +
  labs(title = "Total omset per bulan",
       subtitle = "Data Latihan",
       x = "Bulan",
       y = "Total omset") +
  theme(legend.position = "none",
        axis.text.y = element_blank())
```

#### Analisa per `id_transaksi`

Kita akan hitung beberapa parameter, yakni:

1. Berapa banyak _jenis item_ yang dibelanjakan konsumen.
1. Berapa banyak _item_ yang dibelanjakan konsumen.
1. Omset per konsumen.

Semua dihitung per bulan

```{r,message=FALSE,warning=FALSE}
analisa_konsumen = 
  data %>% 
  mutate(omset = qty * total_harga) %>% 
  group_by(bulan,id_transaksi) %>% 
  summarise(banyak_jenis_item = n(),
            banyak_item = sum(qty),
            omset = sum(omset)) %>% 
  ungroup()
  
analisa_konsumen
```


Dari data di atas, kita akan hitung kembali pada setiap bulannya:

> Ada berapa banyak konsumen yang membeli dan berapa rata-rata item dan omsetnya?

```{r,message=FALSE,warning=FALSE}
analisa_new = 
  analisa_konsumen %>% 
  group_by(bulan) %>% 
  summarise(banyak_konsumen = n(),
            mean_jenis_item = mean(banyak_jenis_item),
            mean_item = mean(banyak_item),
            mean_omset = mean(omset)) %>% 
  ungroup()

analisa_new
```

Kunci jawaban dari tugas `perubahan habit belanja` ada di [_link_](https://ikanx101.com/blog/minimarket-bekasi/) berikut.